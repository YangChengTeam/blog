# 关于互动作业抓包
## 背景
**51答案需要数据**
互动作业主要提供在线中小学答案服务
提供网站和app两种主要渠道。

## 需求
抓取互动作业的信息和答案图片   

## 目标分析    
一般来讲首先肯定是浏览目标的网站和app。    
对于非会员服务来讲：网站的抓取要比app容易很多    
对于会员服务来讲：app要比网站有更多的可能性     
通过使用网站和app。非会员形式。非接口形式。    


## 抓取网页   
问题就转化为如何抓取网页。    
抓取网页就很简单了。查看[互动作业数据抓取](js/hdzj.js)    
然而问题还没有完。    

- 问题1         
图片下载不下来    
通过分析原来是图片上有超时处理    

- 问题2     
网站上的详细答案不全    

- 问题3    
由于原来根据id进行抓包 可以直接循环
后来目标将后台的id改为字符串。
经过样本对比分析：    
加密算法被测试出来    
177023      
http://www.hdzuoye.com/detail/j06wlmdvkajl146bdd2f8a1okdzjpnm      
n = 0     
p = 2     
k = 7     
m = 1      

## app分析   
 
### 对目标app进行反编绎分析       
目标app 360加固             
在模拟器dump出dex可惜不完整 但是对整个分析还是很有帮助的         

### 抓包
通过分析 目标app采有https+pining           
可通过在模拟器安装xpose+justtrustme进行抓包       
目标返回数据的详细数据也进行了加密处理。由于dump不是很完整     
加密算法很难破解【暂罢】    
但是索性找到了【图片上有超时处理】的代码     
图片校验可破解： 查看[互动作业数据抓取](js/hdzj.js)     

### 自动化模拟   
具代查看: [详细代码](hdzy/autojs/)   

由于现在只需要下载答案详细部分。恰好互动作业中有一个下载答案的按钮。       
肯定是存到了某个地方。直接用安装xpose文件监控模块找到了对应目录。        
接下来就是模拟整个过程：具代查看: [详细代码](hdzy/autojs/common.js)         
搜索书名-下载-重命名-传到电脑        
利用autojs自动化工具以及MuMu模拟器的共享文件夹功能完整的下载了答案图片         

- 问题1    
下载有重复的图片 一般是1、2两张      
这个去除就行 具代查看: [详细代码](hdzy/autojs/rnpic.js)    

- 问题2       
搜索限制：后台后来加了100本搜索限制             
一次只下载100本就行               
然后利用自动卸载安装登录脚本 重新下载就行具代查看: [详细代码](hdzy/autojs/login.js)                 

至此：互动作业数据基本能自动化入库           






